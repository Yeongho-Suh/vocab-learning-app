# 영어 단어 학습 웹 서비스 - 프로젝트 계획

## 프로젝트 개요

**목표:** 저장한 영어 단어와 한글 뜻, 예문을 매일 랜덤으로 보여주는 웹 서비스

**배포 URL:** https://my-daily-vocab.vercel.app

### 핵심 요구사항
- 저장한 영어 단어와 한글 뜻, 예문을 매일 랜덤으로 보여주는 웹 서비스
- 위 단어는 매일 오전 6시(KST)에 랜덤으로 바뀜
- 단어가 한번 노출되면 다른 단어가 모두 노출될때까지는 보여지지 않음
- 영어단어, 한글 뜻, 예문은 Notion 데이터베이스에 저장되어 있음
- PC(회사/집), 모바일 등 모든 기기에서 접속 가능

---

## 시스템 구성

### 아키텍처
```
[사용자 브라우저] → [Vercel (Next.js)] → [Notion API]
                     ↑                        ↑
              프론트엔드 + API           데이터 + 상태 관리
```

### 프론트엔드
- **Next.js 16** (App Router) + **React 19**
- 단어 카드 UI (단어, 한글/영어 뜻, 예문)
- 예문 내 단어 하이라이트 (어근 기반 매칭, 빨간색 표시)
- 반응형 디자인 (모바일 우선)
- 다음 갱신 시간 카운트다운 표시
- 학습 진행률 표시 (전체/학습/남은 단어 수)

### 백엔드
- **Next.js API Routes** (Serverless Functions)
  - `GET /api/word` - 오늘의 단어 조회
  - `POST /api/refresh` - 수동 단어 교체 (인증 필요)
- Notion API 연동 (REST API, `Notion-Version: 2022-06-28`)

### 데이터 및 상태 관리
- **Notion 데이터베이스** 단일 사용 (별도 DB 없음)
- 단어 데이터: Word, Meaning (Kor), Meaning (Eng), Example 속성
- 노출 이력: **ShownDate** 날짜 속성으로 관리
- Serverless 환경 호환 (로컬 파일 시스템 미사용)

### 단어 갱신 방식
- 별도 스케줄러(Cron) 없음
- 사용자가 접속할 때 KST 오전 6시 기준으로 날짜를 판단
- 오늘 날짜에 해당하는 단어가 없으면 자동으로 새 단어 선택
- 이미 선택된 단어가 있으면 그대로 반환

---

## 핵심 기능 상세

### 1. Notion API 연동 (`lib/notion.js`)
- `ensureShownDateProperty()` - ShownDate 속성이 없으면 자동 생성
- `getAllWords()` - 전체 단어 목록 조회 (페이지네이션 처리)
- `updateShownDate(pageId, dateString)` - 특정 단어의 노출 날짜 기록
- `clearAllShownDates(words)` - 전체 이력 초기화 (새 사이클 시작)
- `rich_text` 배열 전체 연결 (특수 문자로 인한 텍스트 잘림 방지)

### 2. 단어 선택 로직 (`lib/wordManager.js`)
- `getTodayWord()` - 오늘의 단어 반환 (없으면 새로 선택)
- `selectNewWord()` - ShownDate가 없는 단어 중 랜덤 선택
- `getStatus()` - 전체/학습/남은 단어 수 반환
- KST 오전 6시 기준 날짜 판단 (`getKSTLogicalDate()`)
- 모든 단어 노출 완료 시 자동 초기화 후 새 사이클 시작

### 3. 예문 하이라이트 (`app/page.js`)
- 단어의 어근(stem)을 추출하여 예문에서 매칭
- 영어 형태 변화 처리 (e.g., denounce → denouncing)
- 접미사 제거: -ing, -ed, -es, -er, -ly, -tion 등
- 끝 'e' 제거로 e-dropping 처리 (denounce → denounc)
- 3글자 이하 단어(of, a, the 등) 필터링

---

## 데이터 구조

### Notion 데이터베이스
| 컬럼명 | 타입 | 설명 | 예시 |
|--------|------|------|------|
| **Word** | Title | 영어 단어 | `abundant` |
| **Meaning (Kor)** | Rich Text | 한글 뜻 | `풍부한, 많은` |
| **Meaning (Eng)** | Rich Text | 영어 뜻 | `existing in large quantities` |
| **Example** | Rich Text | 예문 | `The region has abundant natural resources.` |
| **ShownDate** | Date | 노출 날짜 (자동 관리) | `2026-02-20` |

### 상태 관리 방식
```
ShownDate가 오늘(KST 6AM 기준) → 오늘의 단어로 반환
ShownDate가 없음 → 아직 노출되지 않은 단어 (선택 대상)
ShownDate가 과거 → 이미 노출된 단어 (선택 제외)
모든 단어에 ShownDate 있음 → 전체 초기화 후 새 사이클
```

---

## 기술 스택

| 구분 | 기술 | 버전 |
|------|------|------|
| 프레임워크 | Next.js (App Router) | 16.1.6 |
| UI | React | 19.2.4 |
| 데이터/상태 | Notion API (REST) | 2022-06-28 |
| 호스팅 | Vercel | - |
| 코드 관리 | GitHub | - |
| 패키지 관리 | npm | - |

### 의존성 (`package.json`)
- `next` ^16.1.6
- `react` / `react-dom` ^19.2.4
- `@notionhq/client` ^5.9.0 (설치되어 있으나 직접 fetch 사용)
- `dotenv` ^17.3.1

---

## 프로젝트 구조

```
vocab-learning-app/
├── app/
│   ├── page.js              # 메인 UI (단어 카드, 하이라이트)
│   ├── layout.js            # 레이아웃 및 메타데이터
│   ├── globals.css          # 전역 스타일
│   └── api/
│       ├── word/route.js    # GET /api/word - 오늘의 단어
│       └── refresh/route.js # POST /api/refresh - 수동 교체
├── lib/
│   ├── notion.js            # Notion API 연동
│   └── wordManager.js       # 단어 선택/이력 관리 로직
├── docs/                    # 프로젝트 문서
├── .env.local               # 환경변수 (Git 제외)
├── .env.example             # 환경변수 템플릿
├── package.json
└── README.md
```

---

## 개발환경 세팅

### 필수 설치 프로그램

| 프로그램 | 용도 | 다운로드 |
|---------|------|---------|
| **Node.js** (LTS, v18+) | JavaScript 런타임 | https://nodejs.org |
| **Git** | 소스코드 버전 관리 | https://git-scm.com |
| **VS Code** | 코드 에디터 | https://code.visualstudio.com |

### Git 초기 설정 (각 컴퓨터에서 1회)

```bash
git config --global user.name "Yeongho-Suh"
git config --global user.email "zxczxc1680@gmail.com"
```

### 새 컴퓨터에서 시작하기

```bash
# 프로젝트 클론
git clone https://github.com/Yeongho-Suh/vocab-learning-app.git
cd vocab-learning-app

# 패키지 설치
npm install

# 환경변수 설정
# .env.local 파일 생성 후 아래 내용 입력:
# NOTION_API_KEY=ntn_xxxxxxxxxxxx
# NOTION_DATABASE_ID=xxxxxxxxxxxx

# 개발 서버 실행
npm run dev
# → http://localhost:3000 접속 확인
```

### 환경 변수 관리

```bash
# .env.local (각 컴퓨터마다 수동 생성, Git에 포함되지 않음)
NOTION_API_KEY=ntn_xxxxxxxxxxxx
NOTION_DATABASE_ID=xxxxxxxxxxxx

# .env.example (Git에 포함, 템플릿 역할)
NOTION_API_KEY=your_notion_api_key_here
NOTION_DATABASE_ID=your_database_id_here
```

> `.env.local`은 API 키가 포함되어 있으므로 **절대 Git에 커밋하지 않습니다.**
> 새 컴퓨터에서는 `.env.example`을 참고하여 `.env.local`을 직접 생성하세요.

---

## 구현 완료 항목

1. Notion 데이터베이스 생성 및 단어 52개 입력
2. Notion API Integration 설정
3. Notion API 연동 모듈 구현 (`lib/notion.js`)
4. 랜덤 단어 선택 로직 구현 (`lib/wordManager.js`)
5. Notion ShownDate 기반 노출 이력 관리 (Serverless 호환)
6. KST 오전 6시 기준 자동 갱신 (스케줄러 불필요)
7. 프론트엔드 UI 구현 (반응형, 모바일 최적화)
8. 예문 내 단어 하이라이트 (어근 기반)
9. GitHub 연동 및 Vercel 배포 완료
10. GitHub Push 시 자동 배포 설정

---

**작성일:** 2026-02-13
**마지막 업데이트:** 2026-02-20
